<!-- sldsValidatorIgnore -->
<!--
  @description       : 
  @author            : tom@ansleyllc.com
  @group             : 
  @last modified on  : 11-21-2021
  @last modified by  : tom.h.ansley@medtronic.com
  Modifications Log 
  Ver   Date         Author                       Modification
  1.0   08-12-2020   tom@ansleyllc.com   Initial Version
  2.0   07-28-2021   tom@ansleyllc.com   Changed all strings to labels.

-->
<template>
    <template if:true={spinner}>
        <lightning-spinner alternative-text="Loading" class="pageSpinnerHolder"></lightning-spinner>
    </template>

    <!-- ------------------------------------------------------------------------ -->
    <!-- Section which handles the initialization of the list views if its needed -->
    <!-- ------------------------------------------------------------------------ -->
    <lightning-card>
        <template if:false={showProgress}>
            <lightning-layout>
                <lightning-layout-item alignment-bump="right" flexibility="grow" padding="horizontal-small">
                    <div style="padding-left: 10px;">
                        <template if:false={isInitialized}>
                            <lightning-icon icon-name="standard:first_non_empty" 
                                            alternative-text={label.Not_Initialized} 
                                            title={label.Not_Initialized}>
                            </lightning-icon>&nbsp;&nbsp;
                            {label.List_Views_Need_Initialized}  
                        </template>
                        <template if:true={isInitialized}>    
                            <lightning-icon icon-name="standard:task2" 
                                            alternative-text={label.List_Views_Initialized} 
                                            title={label.List_Views_Initialized} >
                            </lightning-icon>&nbsp;&nbsp;
                            {label.List_Views_Initialized}  
                        </template>
                        </div>
                    </lightning-layout-item>
                    <lightning-layout-item padding="horizontal-small" >
                        <lightning-button variant="brand" label={label.Refresh} title={label.Refresh_List_Views} icon-name="action:new_task" class="slds-m-left_x-small" onclick={handleProcessListViewsButtonClick}></lightning-button>
                    </lightning-layout-item>
            </lightning-layout>
        </template>
        <template if:true={showProgress}>
            <c-simpli-u-i-list-views-init-progress-bar batch-id={batchId}
                                                        working-text={label.Processing_Status}
                                                        complete-text={label.List_View_Processing_Complete}>
            </c-simpli-u-i-list-views-init-progress-bar>
        </template>
    </lightning-card>

    <br/>

    <lightning-card>
        <c-simpli-u-i-list-views-schedule-job time-period="minutely"
                                              onupdated={handleScheduleJobRefreshed}>
        </c-simpli-u-i-list-views-schedule-job>
    </lightning-card>

    <br/>

    <!-- ------------------------------------------------------------------------------- -->
    <!-- Section which handles the displaying of all the org wide configuration settings -->
    <!-- ------------------------------------------------------------------------------- -->
    <template if:true={config}>
        <table class="slds-table slds-table_bordered">
            <thead>
                <tr>
                    <th scope="col">
                        <div class="slds-truncate" title={label.Parameter_Name}>{label.Parameter_Name}</div>
                    </th>
                    <th scope="col">
                        <div class="slds-truncate" title={label.Value}>{label.Value}</div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <template for:each={config.parameters} for:item="param">
                    <tr key={param.name} class="slds-hint-parent">

                        <td key={param.name} style="width: 30%;">
                            <div key={param.name} class="slds-truncate" title={param.name}>
                                {param.label}
                                &nbsp;
                                <div key={param.name} class="slds-wrap" style="white-space:normal; font-size:0.75em" title={param.name}>
                                    {param.description}
                                </div>
                            </div>
                        </td>
                        <td key={param.name} data-label={param.name} style="width: 70%;">
                            <div class="slds-form-element__control" title={param.value}>
                                <template if:true={param.isBoolean}>
                                    <lightning-combobox placeholder={label.Select_A_Value}
                                                        onblur={handleParamUpdate}
                                                        options={booleanList}
                                                        variant=label-hidden
                                                        value={param.value}
                                                        name={param.name}
                                                        label={param.label}
                                                        disabled={param.readOnly}>
                                    </lightning-combobox>                        
                                </template>
                                <template if:false={param.isBoolean}>
                                    <template if:true={param.isListString}>
                                        <lightning-dual-listbox name={param.name}
                                                                label={param.label}
                                                                source-label={label.Available}
                                                                selected-label={label.Selected}
                                                                options={objNamesList}
                                                                onchange={handleParamUpdate}
                                                                variant=label-hidden
                                                                value={param.listValues}
                                                                size=4
                                                                disabled={param.readOnly}>
                                        </lightning-dual-listbox>
                                    </template>
                                    <template if:false={param.isListString}>
                                        <lightning-input type={param.type} 
                                                            variant="label-hidden"
                                                            name={param.name} 
                                                            onchange={handleParamUpdate}
                                                            placeholder={param.placeHolder}
                                                            value={param.value}
                                                            label={param.label}
                                                            disabled={param.readOnly}>
                                        </lightning-input>
                                    </template>
                                </template>
                            </div>
                        </td>
                    </tr>
                </template>            
            </tbody>
        </table>      
    </template>   

    <footer class="slds-modal__footer" style="min-width: 1100px;">
        <button class="slds-button slds-button_brand" onclick={handleSaveClick}>{label.Save}</button>
    </footer>
</template>